# -*- coding: utf-8 -*-

# --- –ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ ---

# `requests` - –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ (—Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü).
import requests
# `os` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–ø–æ–∫ –∏ –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º).
import os
# `re` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ (–¥–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –≤ —Ç–µ–∫—Å—Ç–µ).
import re
# `json` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –¥–∞–Ω–Ω—ã—Ö JSON (–¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤).
import json
# `pandas` - –º–æ—â–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è Excel-—Ñ–∞–π–ª–∞.
import pandas as pd
# `BeautifulSoup` - –≥–ª–∞–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML-–∫–æ–¥–∞ (–∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü).
# `Tag` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤ HTML-—Ç–µ–≥–æ–≤.
from bs4 import BeautifulSoup, Tag
# `urljoin`, `urlparse` - –¥–ª—è —É–¥–æ–±–Ω–æ–π –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å URL-–∞–¥—Ä–µ—Å–∞–º–∏.
from urllib.parse import urljoin, urlparse
# `Counter` - —É–¥–æ–±–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è).
from collections import Counter
# `sys`, `io` - –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ Windows).
import sys
import io
# `concurrent.futures` - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á.
# `ThreadPoolExecutor` –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è I/O-bound –æ–ø–µ—Ä–∞—Ü–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã.
from concurrent.futures import ThreadPoolExecutor, as_completed

# --- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ –¥–ª—è –≤—ã–≤–æ–¥–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª ---
# –≠—Ç–∞ —Å–µ–∫—Ü–∏—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ä—É—Å—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –±—É–¥—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏.
sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8')
sys.stderr = io.TextIOWrapper(sys.stderr.buffer, encoding='utf-8')

# --- 1. –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò –°–ö–†–ò–ü–¢–ê ---

# –°–ø–∏—Å–æ–∫ URL-–∞–¥—Ä–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –±—É–¥–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å.
URLS_TO_ANALYZE = [
    "https://docs.selectel.ru/cloud-servers/create/create-server/",
    "https://docs.selectel.ru/managed-kubernetes/clusters/logs/",
    "https://docs.selectel.ru/object-storage/quickstart/"
]
# –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏, –∫—É–¥–∞ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è —Å–∫–∞—á–∞–Ω–Ω—ã–µ HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–ª—è –∞—Ä—Ö–∏–≤–∞).
OUTPUT_DIR = "downloaded_pages"
# –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏, –∫—É–¥–∞ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –∏—Ç–æ–≥–æ–≤—ã–µ —Ñ–∞–π–ª—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞.
ANALYSIS_RESULTS_DIR = "analysis_results"
# *** –ò–ó–ú–ï–ù–ï–ù–ò–ï: –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ ***
# –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ JSON-—Ñ–∞–π–ª—É. os.path.join –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø—É—Ç–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –û–° (Windows/Linux/macOS).
JSON_RESULTS_FILE = os.path.join(ANALYSIS_RESULTS_DIR, "task1_analysis_results.json")
# –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ Excel-—Ñ–∞–π–ª—É.
EXCEL_RESULTS_FILE = os.path.join(ANALYSIS_RESULTS_DIR, "task1_analysis_results.xlsx")
# –°–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–≤—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –±—É–¥–µ–º –∏—Å–∫–∞—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö.
TOOLS_KEYWORDS = ['API', 'Terraform', 'CLI', 'Ansible', 'Kubernetes', 'Docker', 'SDK']
# –ó–∞–≥–æ–ª–æ–≤–∫–∏ HTTP-–∑–∞–ø—Ä–æ—Å–∞. `User-Agent` –∏–º–∏—Ç–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞, —á—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç —à–∞–Ω—Å—ã –Ω–∞ —É—Å–ø–µ—à–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ.
HEADERS = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36'
}
# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Å—ã–ª–æ–∫.
MAX_WORKERS_FOR_LINKS = 10


def print_report(result: dict):
    """
    –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–π –ø–µ—á–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª.
    –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –¥–ª—è –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
    """
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –∞–Ω–∞–ª–∏–∑ —É—Å–ø–µ—à–Ω—ã–º.
    if result["status"] == "Success":
        # –ü–µ—á–∞—Ç–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
        print(f"‚ÑπÔ∏è Title: {result['title']}")
        print(f"‚ÑπÔ∏è Description: {result['description']}")
        print(f"‚úÖ –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: {result['last_update_date']}")
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ —Ç–∞–±–ª–∏—Ü —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: {result['tables_count']}")

        # –ü–µ—á–∞—Ç–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–ª–æ–∫–∞—Ö –∫–æ–¥–∞.
        code_blocks_count = result['code_blocks_count']
        if code_blocks_count > 0:
            # –§–æ—Ä–º–∏—Ä—É–µ–º –∫—Ä–∞—Å–∏–≤—É—é —Å—Ç—Ä–æ–∫—É —Å–æ —Å–ø–∏—Å–∫–æ–º —è–∑—ã–∫–æ–≤ –∏ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º.
            lang_summary = ", ".join([f"{lang}: {count}" for lang, count in result['code_languages'].items()])
            print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ –±–ª–æ–∫–æ–≤ —Å –∫–æ–¥–æ–º: {code_blocks_count} ({lang_summary})")
        else:
            print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ –±–ª–æ–∫–æ–≤ —Å –∫–æ–¥–æ–º: 0")

        # –ü–µ—á–∞—Ç–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö.
        found_tools = result['found_tools']
        if found_tools:
            # –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É —Å–æ —Å–ø–∏—Å–∫–æ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏—Ö —É–ø–æ–º–∏–Ω–∞–Ω–∏–π.
            tools_summary = ", ".join([f"{tool}: {count}" for tool, count in found_tools.items()])
            print(f"‚úÖ –£–ø–æ–º—è–Ω—É—Ç—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã: {tools_summary}")
        else:
            print("‚úÖ –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.")

        # –ü–µ—á–∞—Ç–∞–µ–º —Å–≤–æ–¥–∫—É –ø–æ —Å—Å—ã–ª–∫–∞–º.
        links = result['links_summary']
        print(f"‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Å—ã–ª–æ–∫: {links['total_links']} (–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ: {links['internal_links']}, –í–Ω–µ—à–Ω–∏–µ: {links['external_links']})")

        # –ï—Å–ª–∏ –µ—Å—Ç—å –±–∏—Ç—ã–µ —Å—Å—ã–ª–∫–∏, –≤—ã–≤–æ–¥–∏–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ.
        if links['broken_links'] > 0:
            print(f"‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ –±–∏—Ç—ã—Ö —Å—Å—ã–ª–æ–∫: {links['broken_links']}")
        else:
            print(f"‚úÖ –ë–∏—Ç—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã.")
    else:
        # –ï—Å–ª–∏ –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è, –ø–µ—á–∞—Ç–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.
        print(f"‚ùå –û–®–ò–ë–ö–ê: –ê–Ω–∞–ª–∏–∑ –Ω–µ —É–¥–∞–ª—Å—è. –ü—Ä–∏—á–∏–Ω–∞: {result.get('error_message', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞')}")


def check_link(url: str) -> tuple[str, bool]:
    """
    –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –û–î–ù–û–ô —Å—Å—ã–ª–∫–∏.
    –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HEAD-–∑–∞–ø—Ä–æ—Å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏, —á—Ç–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —Å–∫–∞—á–∏–≤–∞—Ç—å –≤—Å—ë —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ç–µ–∂ (URL, is_broken), –≥–¥–µ is_broken - True, –µ—Å–ª–∏ —Å—Å—ã–ª–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.
    """
    try:
        # HEAD-–∑–∞–ø—Ä–æ—Å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–µ–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
        # allow_redirects=True –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã.
        response = requests.head(url, headers=HEADERS, allow_redirects=True, timeout=5)
        # –°—á–∏—Ç–∞–µ–º —Å—Å—ã–ª–∫—É "–±–∏—Ç–æ–π", –µ—Å–ª–∏ –∫–æ–¥ –æ—Ç–≤–µ—Ç–∞ 400 –∏–ª–∏ –≤—ã—à–µ (–æ—à–∏–±–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞).
        if response.status_code >= 400:
            return url, True
        return url, False
    except requests.RequestException:
        # –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –ª—é–±–∞—è —Å–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ (—Ç–∞–π–º-–∞—É—Ç, –Ω–µ—Ç DNS), —Å—á–∏—Ç–∞–µ–º —Å—Å—ã–ª–∫—É "–±–∏—Ç–æ–π".
        return url, True


def analyze_documentation_page(url: str, link_status_cache: dict) -> dict:
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ–¥–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    –∏ –í–û–ó–í–†–ê–©–ê–ï–¢ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤–∏–¥–µ –°–õ–û–í–ê–†–Ø.

    :param url: URL-–∞–¥—Ä–µ—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.
    :param link_status_cache: –°–ª–æ–≤–∞—Ä—å –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ —Å—Å—ã–ª–æ–∫ (url -> is_broken),
                              —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Å—Å—ã–ª–∫—É –º–Ω–æ–≥–æ —Ä–∞–∑.
    """
    # –í—ã–≤–æ–¥–∏–º –∑–∞–≥–æ–ª–æ–≤–æ–∫, —á—Ç–æ–±—ã –æ—Ç–¥–µ–ª–∏—Ç—å –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –∫–æ–Ω—Å–æ–ª–∏.
    print(f"\n{'='*20} –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—ã: {url} {'='*20}")
    # –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å—Ç–∞—Ç—É—Å "Failed".
    page_result = {"url": url, "status": "Failed"}

    # –ë–ª–æ–∫ try...except –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–∞–π—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω).
    try:
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ URL –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É.
        response = requests.get(url, headers=HEADERS, timeout=15)
        # –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–¥–∏—Ä–æ–≤–∫—É –æ—Ç–≤–µ—Ç–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º —Å —Ä—É—Å—Å–∫–∏–º–∏ –±—É–∫–≤–∞–º–∏.
        response.encoding = 'utf-8'
        # –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª –∫–æ–¥ –æ—à–∏–±–∫–∏ (4xx –∏–ª–∏ 5xx), —ç—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –≤—ã–∑–æ–≤–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.
        response.raise_for_status()

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º "—Å—ã—Ä–æ–π" HTML-–∫–æ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª.
        filename = re.sub(r'[^a-zA-Z0-9]', '_', url) + ".txt"
        filepath = os.path.join(OUTPUT_DIR, filename)
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(response.text)

        # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç BeautifulSoup –∏–∑ HTML-–∫–æ–¥–∞ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞.
        soup = BeautifulSoup(response.text, 'html.parser')
        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤–µ—Å—å —Ç–µ–∫—Å—Ç —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –ø—Ä–∏–≤–æ–¥–∏–º –µ–≥–æ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–∞.
        page_text_content = soup.get_text().lower()

        # --- –ê–ù–ê–õ–ò–ó (—Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –≤ —Å–ª–æ–≤–∞—Ä—å `page_result`) ---
        page_result["status"] = "Success"  # –ú–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞ "—É—Å–ø–µ—à–Ω–æ".
        page_result["title"] = soup.title.string.strip() if soup.title else "N/A"

        # –ë–µ–∑–æ–ø–∞—Å–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ–º –º–µ—Ç–∞-–æ–ø–∏—Å–∞–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä—è—è, —á—Ç–æ —Ç–µ–≥ –Ω–∞–π–¥–µ–Ω –∏ —É –Ω–µ–≥–æ –µ—Å—Ç—å –Ω—É–∂–Ω—ã–π –∞—Ç—Ä–∏–±—É—Ç.
        description_tag = soup.find('meta', attrs={'name': 'description'})
        if isinstance(description_tag, Tag) and description_tag.has_attr('content'):
            page_result["description"] = description_tag['content'].strip()
        else:
            page_result["description"] = "N/A"

        # ***–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø ‚Ññ2: –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ "—Ö—Ä—É–ø–∫–æ—Å—Ç–∏" —Å–µ–ª–µ–∫—Ç–æ—Ä–∞.***
        # –ò—â–µ–º –¥–∞—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–º—É CSS-–∫–ª–∞—Å—Å—É.
        # –í–ê–ñ–ù–û: –≠—Ç–æ—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å—Ç–∫–∏ —Å–∞–π—Ç–∞ Selectel.
        # –ï—Å–ª–∏ –≤–µ—Ä—Å—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—Å—è, —ç—Ç–æ—Ç –∫–æ–¥ –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Å—Ç–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.
        update_date_tag = soup.find('div', class_='doc-body__last-update')
        page_result["last_update_date"] = update_date_tag.get_text(strip=True) if update_date_tag else "N/A"

        # –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ–≥–æ–≤ <table> –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
        page_result["tables_count"] = len(soup.find_all('table'))

        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –±–ª–æ–∫–∏ —Å –∫–æ–¥–æ–º.
        code_blocks = soup.find_all('pre')
        language_counter = Counter()
        for block in code_blocks:
            code_tag = block.find('code')
            lang = "unknown"
            if code_tag and code_tag.get('class'):
                for css_class in code_tag['class']:
                    if css_class.startswith('language-'):
                        lang = css_class.replace('language-', '')
                        break
            language_counter[lang] += 1
        page_result["code_blocks_count"] = len(code_blocks)
        page_result["code_languages"] = dict(language_counter)

        # –ò—â–µ–º –∫–ª—é—á–µ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —Å—á–∏—Ç–∞–µ–º –∏—Ö —É–ø–æ–º–∏–Ω–∞–Ω–∏—è.
        found_tools_with_counts = {}
        for tool in TOOLS_KEYWORDS:
            # `\b` - –≥—Ä–∞–Ω–∏—Ü–∞ —Å–ª–æ–≤–∞, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "api", –∞ –Ω–µ "terapi").
            matches = re.findall(r'\b' + re.escape(tool.lower()) + r'\b', page_text_content)
            if matches:
                found_tools_with_counts[tool] = len(matches)
        page_result["found_tools"] = found_tools_with_counts

        # *** –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø ‚Ññ1 –∏ ‚Ññ3: –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Å—ã–ª–æ–∫ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º ***
        # 1. –°–±–æ—Ä –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫
        all_links_on_page = soup.find_all('a', href=True)
        internal_links, external_links = 0, 0
        base_url = f"{urlparse(url).scheme}://{urlparse(url).netloc}"

        # –°–æ–±–∏—Ä–∞–µ–º –≤ `set`, —á—Ç–æ–±—ã —Å—Ä–∞–∑—É –æ—Ç—Å–µ—è—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã —Å—Å—ã–ª–æ–∫ –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
        unique_urls_to_check = set()
        for link in all_links_on_page:
            href = link['href']
            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º "—è–∫–æ—Ä–Ω—ã–µ" —Å—Å—ã–ª–∫–∏ (–≤–µ–¥—É—â–∏–µ –Ω–∞ —ç—Ç—É –∂–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É).
            if href.startswith('#') or not href.strip():
                continue

            # –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "/page.html") –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ.
            absolute_url = urljoin(base_url, href)
            unique_urls_to_check.add(absolute_url)

            # –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –∫–∞–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –∏–ª–∏ –≤–Ω–µ—à–Ω—é—é.
            if urlparse(absolute_url).netloc == urlparse(base_url).netloc:
                internal_links += 1
            else:
                external_links += 1

        # 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –±—ã–ª–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã —Ä–∞–Ω–µ–µ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞)
        # –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ —Å—Å—ã–ª–∫–∏, —Å—Ç–∞—Ç—É—Å–∞ –∫–æ—Ç–æ—Ä—ã—Ö –µ—â–µ –Ω–µ—Ç –≤ –Ω–∞—à–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–º –∫—ç—à–µ.
        new_urls_to_check = [u for u in unique_urls_to_check if u not in link_status_cache]

        # 3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Å—Å—ã–ª–æ–∫
        # –°–æ–∑–¥–∞–µ–º –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤. `with` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø–æ—Ç–æ–∫–∏ –±—É–¥—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω—ã.
        if new_urls_to_check:
            print(f"  -> –ù–∞—á–∏–Ω–∞—é –ø—Ä–æ–≤–µ—Ä–∫—É {len(new_urls_to_check)} –Ω–æ–≤—ã—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ –≤ {MAX_WORKERS_FOR_LINKS} –ø–æ—Ç–æ–∫–æ–≤...")
            with ThreadPoolExecutor(max_workers=MAX_WORKERS_FOR_LINKS) as executor:
                # `executor.map` –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `check_link` –∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É `new_urls_to_check`.
                # –≠—Ç–æ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –ø–æ –º–µ—Ä–µ –∏—Ö –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.
                future_to_url = {executor.submit(check_link, u): u for u in new_urls_to_check}
                for future in as_completed(future_to_url):
                    u, is_broken = future.result()
                    # –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—à –∫—ç—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —ç—Ç—É —Å—Å—ã–ª–∫—É –≤ –±—É–¥—É—â–µ–º.
                    link_status_cache[u] = is_broken
            print("  -> –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Å—ã–ª–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.")

        # 4. –ü–æ–¥—Å—á–µ—Ç –±–∏—Ç—ã—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ –¢–ï–ö–£–©–ï–ô —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –∏—Å–ø–æ–ª—å–∑—É—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫—ç—à
        broken_links_count = 0
        for u in unique_urls_to_check:
            if link_status_cache.get(u, False): # –ï—Å–ª–∏ —Å—Å—ã–ª–∫–∞ –≤ –∫—ç—à–µ –∏ –æ–Ω–∞ '–±–∏—Ç–∞—è'
                broken_links_count += 1

        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Å–≤–æ–¥–∫—É –ø–æ —Å—Å—ã–ª–∫–∞–º –≤ –Ω–∞—à —Å–ª–æ–≤–∞—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
        page_result["links_summary"] = {
            "total_links": len(all_links_on_page),
            "internal_links": internal_links,
            "external_links": external_links,
            "broken_links": broken_links_count
        }

    # –ï—Å–ª–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–ª–æ–∫–∞ try –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞, –º—ã "–ª–æ–≤–∏–º" –µ–µ –∑–¥–µ—Å—å.
    except requests.exceptions.RequestException as e:
        page_result["error_message"] = str(e)
    except Exception as e:
        page_result["error_message"] = str(e)

    # --- –í–´–í–û–î –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –í –¢–ï–†–ú–ò–ù–ê–õ ---
    print_report(page_result)
    print(f"{'='*25} –ö–æ–Ω–µ—Ü –∞–Ω–∞–ª–∏–∑–∞ {'='*25}")

    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.
    return page_result


# --- –û–°–ù–û–í–ù–û–ô –ë–õ–û–ö –ò–°–ü–û–õ–ù–ï–ù–ò–Ø –°–ö–†–ò–ü–¢–ê ---
# `if __name__ == "__main__":` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞,
# –∫–æ–≥–¥–∞ –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º —ç—Ç–æ—Ç —Ñ–∞–π–ª –Ω–∞–ø—Ä—è–º—É—é, –∞ –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –µ–≥–æ –≤ –¥—Ä—É–≥–æ–π —Å–∫—Ä–∏–ø—Ç.
if __name__ == "__main__":
    print("üöÄ –ó–∞–ø—É—Å–∫–∞—é —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏...")

    # –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫–∏ –¥–ª—è —Å–∫–∞—á–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –µ—Å–ª–∏ –∏—Ö –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.
    if not os.path.exists(OUTPUT_DIR):
        os.makedirs(OUTPUT_DIR)
    if not os.path.exists(ANALYSIS_RESULTS_DIR):
        os.makedirs(ANALYSIS_RESULTS_DIR)

    # *** –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø ‚Ññ3: –°–æ–∑–¥–∞–µ–º –∫—ç—à –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ —Å—Å—ã–ª–æ–∫ ***
    # –≠—Ç–æ—Ç —Å–ª–æ–≤–∞—Ä—å –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—é –∞–Ω–∞–ª–∏–∑–∞ –∏ –Ω–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.
    # –ö–ª—é—á - URL, –∑–Ω–∞—á–µ–Ω–∏–µ - True (–±–∏—Ç–∞—è) –∏–ª–∏ False (—Ä–∞–±–æ—á–∞—è).
    # –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ —Å—Å—ã–ª–∫–µ, –µ—Å–ª–∏ –æ–Ω–∞ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö.
    master_link_cache = {}

    # –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ–º —Å–æ–±–∏—Ä–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
    all_results = []
    # –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Å—ã–ª–∫–∏ –∏–∑ –Ω–∞—à–µ–≥–æ —Å–ø–∏—Å–∫–∞.
    for url in URLS_TO_ANALYZE:
        # –ü–µ—Ä–µ–¥–∞–µ–º –∫—ç—à –≤ —Ñ—É–Ω–∫—Ü–∏—é –∞–Ω–∞–ª–∏–∑–∞.
        result = analyze_documentation_page(url, master_link_cache)
        all_results.append(result)

    print(f"\nüìä –í—Å–µ–≥–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω–æ {len(master_link_cache)} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Å—ã–ª–æ–∫.")

    # --- –°–û–•–†–ê–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –í –§–ê–ô–õ–´ ---
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Ç–æ–≥–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ –≤ JSON-—Ñ–∞–π–ª.
    with open(JSON_RESULTS_FILE, 'w', encoding='utf-8') as f:
        # `indent=2` –¥–µ–ª–∞–µ—Ç —Ñ–∞–π–ª –∫—Ä–∞—Å–∏–≤–æ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ —á–∏—Ç–∞–µ–º—ã–º.
        # `ensure_ascii=False` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ä—É—Å—Å–∫–∏–µ –±—É–∫–≤—ã.
        json.dump(all_results, f, indent=2, ensure_ascii=False)
    print(f"\n‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ JSON —Ñ–∞–π–ª: {JSON_RESULTS_FILE}")

    # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É DataFrame –∏–∑ —Å–ø–∏—Å–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. `json_normalize` –æ—Ç–ª–∏—á–Ω–æ "—Ä–∞—Å–ø–ª—é—â–∏–≤–∞–µ—Ç" –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞—Ä–∏.
    df = pd.json_normalize(all_results, sep='_')
    # –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–ª–±—Ü—ã –¥–ª—è –±–æ–ª—å—à–µ–π –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –≤ Excel.
    df.rename(columns={
        'links_summary_total_links': 'Total Links',
        'links_summary_internal_links': 'Internal Links',
        'links_summary_external_links': 'External Links',
        'links_summary_broken_links': 'Broken Links'
    }, inplace=True)
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É –≤ Excel-—Ñ–∞–π–ª. `index=False` —É–±–∏—Ä–∞–µ—Ç –ª–∏—à–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏.
    df.to_excel(EXCEL_RESULTS_FILE, index=False, engine='openpyxl')
    print(f"‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ Excel —Ñ–∞–π–ª: {EXCEL_RESULTS_FILE}")

    print("\nüéâ –í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.")